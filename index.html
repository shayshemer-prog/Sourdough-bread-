<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#8B4513">
    <title>××“×¨×™×š ×œ××¤×™×™×ª ×œ×—× ××—××¦×ª</title>
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiU291cmRvdWdoIEJyZWFkIEd1aWRlIiwic2hvcnRfbmFtZSI6IlNvdXJkb3VnaCIsInN0YXJ0X3VybCI6Ii8iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsImJhY2tncm91bmRfY29sb3IiOiIjZmZmZmZmIiwidGhlbWVfY29sb3IiOiIjOEI0NTEzIn0=">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #f5e6d3 0%, #d4a574 100%);
            min-height: 100vh;
            padding-bottom: 80px;
            direction: rtl;
        }
        
        .header {
            background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
            color: white;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header h1 {
            font-size: 1.5em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: space-between;
        }
        
        .active-timers {
            font-size: 0.7em;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .timer-pulse {
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .progress-bar {
            background: rgba(255,255,255,0.3);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .progress-fill {
            background: white;
            height: 100%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .step-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .step-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .step-number {
            background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .step-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #2c3e50;
            flex: 1;
            margin-left: 15px;
        }
        
        .step-content {
            color: #555;
            line-height: 1.6;
            margin: 15px 0;
        }
        
        .ingredients {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .ingredients h4 {
            color: #8B4513;
            margin-bottom: 10px;
        }
        
        .ingredient-item {
            padding: 5px 0;
            color: #555;
        }
        
        .timer-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .timer-display {
            font-size: 2.5em;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
            font-variant-numeric: tabular-nums;
        }
        
        .timer-label {
            text-align: center;
            opacity: 0.9;
            margin-bottom: 15px;
        }
        
        .timer-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:active {
            transform: scale(0.95);
        }
        
        .btn-primary {
            background: white;
            color: #667eea;
        }
        
        .btn-primary:hover {
            background: #f0f0f0;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }
        
        .btn-next {
            background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
            color: white;
            width: 100%;
            margin-top: 20px;
            justify-content: center;
            font-size: 1.1em;
        }
        
        .btn-back {
            background: #95a5a6;
            color: white;
            margin-top: 10px;
        }
        
        .navigation {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .completion {
            text-align: center;
            padding: 40px 20px;
        }
        
        .completion h2 {
            color: #8B4513;
            font-size: 2em;
            margin: 20px 0;
        }
        
        .completion-icon {
            font-size: 4em;
        }
        
        .tips {
            background: #fff9e6;
            border-left: 4px solid #f39c12;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
        }
        
        .tips strong {
            color: #f39c12;
        }
        
        .hidden {
            display: none;
        }
        
        .temperature {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 10px 15px;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: 500;
            color: #2e7d32;
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            .step-card {
                padding: 20px;
            }
            
            .timer-display {
                font-size: 2em;
            }
            
            .btn {
                padding: 10px 16px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>
            <span>ğŸ ××“×¨×™×š ×œ×—× ××—××¦×ª</span>
            <span class="active-timers" id="activeTimersIndicator"></span>
        </h1>
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>
    </div>
    
    <div class="container">
        <div id="stepContainer"></div>
    </div>

    <script>
        const recipeSteps = [
            {
                title: "×”×›× ×ª ×”×©××•×¨",
                content: "×•×“××• ×©×©××•×¨ ×”××—××¦×ª ×©×œ×›× ×¤×¢×™×œ ×•××‘×¢×‘×¢. ×”×•× ×¦×¨×™×š ×œ×”×›×¤×™×œ ××ª ×¢×¦××• ×‘×’×•×“×œ ×•×œ×¢×‘×•×¨ ××ª ××‘×—×Ÿ ×”×¦×™×¤×” (×›×¤×™×ª ×©××•×¨ ×¦×¤×” ×‘××™×).",
                ingredients: [
                    "100 ×’×¨× ×©××•×¨ ×¤×¢×™×œ",
                    "500 ×’×¨× ×§××— ×œ×—× (××• ×§××— ×¨×’×™×œ)",
                    "350 ×’×¨× ××™× (×‘×˜××¤×¨×˜×•×¨×ª ×”×—×“×¨)",
                    "10 ×’×¨× ××œ×—"
                ],
                timer: null,
                tips: "×× ×”×©××•×¨ ×œ× ×”×•×–×Ÿ ×œ××—×¨×•× ×”, ×”××›×™×œ×• ××•×ª×• 4-8 ×©×¢×•×ª ×œ×¤× ×™ ×”×”×ª×—×œ×”. ×”×•× ×¦×¨×™×š ×œ×”×¨×™×— ×—××¦××¥ ×•××ª×•×§ ××¢×˜."
            },
            {
                title: "××•×˜×•×œ×™×–×” (×¢×¨×‘×•×‘ ×§××— ×•××™×)",
                content: "×¢×¨×‘×‘×• ××ª ×”×§××— ×•-325 ×’×¨× ××™× (×©××¨×• 25 ×’×¨× ×œ×××•×—×¨ ×™×•×ª×¨) ×‘×§×¢×¨×” ×’×“×•×œ×”. ×¢×¨×‘×‘×• ×¢×“ ×©×œ× × ×©××¨ ×§××— ×™×‘×©. ×–×” ×××¤×©×¨ ×œ×§××— ×œ×”×¡×¤×’ ×•××¤×ª×— ×’×œ×•×˜×Ÿ ×‘××•×¤×Ÿ ×˜×‘×¢×™.",
                timer: { duration: 30, label: "×× ×•×—×ª ××•×˜×•×œ×™×–×”" },
                tips: "××œ ×ª×•×¡×™×¤×• ××œ×— ××• ×©××•×¨ ×¢×“×™×™×Ÿ! ×ª×§×•×¤×ª ×”×× ×•×—×” ×”×–×• ×”×•×¤×›×ª ××ª ×”×‘×¦×§ ×œ×§×œ ×™×•×ª×¨ ×œ×¢×‘×•×“×”."
            },
            {
                title: "×”×•×¡×¤×ª ×©××•×¨ ×•××œ×—",
                content: "×”×•×¡×™×¤×• ××ª ×”×©××•×¨ ×”×¤×¢×™×œ ×•×”××œ×— ×œ×‘×¦×§. ×”×©×ª××©×• ×‘-25 ×’×¨× ×”××™× ×”× ×•×ª×¨×™× ×›×“×™ ×œ×¡×™×™×¢ ×‘×”××¡×ª ×”××œ×—. ×œ×—×¦×• ×”×›×œ ×‘×™×—×“ ×¢× ×”×™×“×™×™× ×¢×“ ×©×”×›×œ ××©×•×œ×‘ ×œ×—×œ×•×˜×™×Ÿ - ×–×” ×™×”×™×” ×“×‘×™×§ ×•××‘×•×œ×’×Ÿ!",
                timer: null,
                tips: "×”×¨×˜×™×‘×• ××ª ×”×™×“×™×™× ×›×“×™ ×œ×× ×•×¢ ×”×™×“×‘×§×•×ª. ×”×‘×¦×§ ×™×”×™×” ×¤×¨×•×¢ ×‘×”×ª×—×œ×” - ×–×” × ×•×¨××œ×™."
            },
            {
                title: "×ª×¡×™×¡×” ×¨××©×•× ×™×ª - ××ª×™×—×” ×•×§×™×¤×•×œ",
                content: "×¢×›×©×™×• ××ª×—×™×œ×” ×”×ª×¡×™×¡×” ×”×¨××©×•× ×™×ª! ×‘××”×œ×š 3-4 ×”×©×¢×•×ª ×”×‘××•×ª, ×‘×¦×¢×• 4 ×¡×˜×™× ×©×œ ××ª×™×—×” ×•×§×™×¤×•×œ, ×‘××¨×•×•×—×™× ×©×œ 30 ×“×§×•×ª. ×œ×‘×™×¦×•×¢ ××ª×™×—×” ×•×§×™×¤×•×œ: ×”×¨×˜×™×‘×• ××ª ×”×™×“×™×™×, ××—×–×• ×‘×¦×“ ××—×“ ×©×œ ×”×‘×¦×§, ××ª×—×• ××•×ª×• ×œ××¢×œ×”, ×•×§×¤×œ×• ××•×ª×•. ×¡×•×‘×‘×• ××ª ×”×§×¢×¨×” 90 ××¢×œ×•×ª ×•×—×–×¨×• 4 ×¤×¢××™×.",
                timer: { duration: 30, label: "××ª×™×—×” ×•×§×™×¤×•×œ ×”×‘×", repeatable: true },
                temperature: "×©××¨×• ×‘×˜××¤×¨×˜×•×¨×” ×©×œ 24-26Â°C. ×—× ×™×•×ª×¨ = ×ª×¡×™×¡×” ××”×™×¨×” ×™×•×ª×¨.",
                tips: "××—×¨×™ 4 ×¡×˜×™× ×©×œ ××ª×™×—×” ×•×§×™×¤×•×œ, ×ª× ×• ×œ×‘×¦×§ ×œ× ×•×— ×œ××©×š 2-2.5 ×©×¢×•×ª ×”× ×•×ª×¨×•×ª. ×”×•× ×¦×¨×™×š ×œ×’×“×•×œ ×‘-30-50% ×‘× ×¤×— ×•×œ×”×¨×’×™×© ××•×•×¨×™×¨×™."
            },
            {
                title: "×¢×™×¦×•×‘ ×•×¢×™×¦×•×‘ ××§×“×™×",
                content: "×”×¤×›×• ××ª ×”×‘×¦×§ ×¢×œ ××©×˜×— ××§×•××— ×§×œ×•×ª. ×¢×¦×‘×• ×‘×¢×“×™× ×•×ª ×œ×›×“×•×¨ ×¢×œ ×™×“×™ ××©×™×›×ª ×”×§×¦×•×•×ª ×œ××¨×›×–. ×ª× ×• ×œ×• ×œ× ×•×— 20-30 ×“×§×•×ª (×× ×•×—×ª ×¡×¤×¡×œ), ×•××– ×‘×¦×¢×• ××ª ×”×¢×™×¦×•×‘ ×”×¡×•×¤×™: ×”×¤×›×• ××•×ª×•, ×¦×¨×• ××ª×— ×¢×œ ×™×“×™ ××©×™×›×ª ×”×‘×¦×§ ×œ×¢×‘×¨×›× ×ª×•×š ×›×“×™ ×¡×™×‘×•×‘.",
                timer: { duration: 25, label: "×× ×•×—×ª ×¡×¤×¡×œ" },
                tips: "××œ ×ª×•×¡×™×¤×• ×™×•×ª×¨ ××“×™ ×§××—! ××ª× ×¨×•×¦×™× ×©×”×‘×¦×§ ×™×™×“×‘×§ ××¢×˜ ×œ×©×•×œ×—×Ÿ ×›×“×™ ×œ×™×¦×•×¨ ××ª×—."
            },
            {
                title: "×ª×¤×™×—×” ×§×¨×” ×‘××§×¨×¨",
                content: "×”× ×™×—×• ××ª ×”×‘×¦×§ ×”××¢×•×¦×‘ ×¢× ×”×¦×“ ×”×ª×¤×•×¨ ×›×œ×¤×™ ××¢×œ×” ×‘×¡×œ ×ª×¡×™×¡×” ××§×•××— ××• ×‘×§×¢×¨×” ××¨×•×¤×“×ª ×‘××’×‘×ª. ×›×¡×• ×”×™×˜×‘ ×•×”×›× ×™×¡×• ×œ××§×¨×¨ ×œ-8-24 ×©×¢×•×ª. ×–×” ××¤×ª×— ×˜×¢× ×•×”×•×¤×š ××ª ×”×—×¨×™×¦×” ×œ×§×œ×” ×™×•×ª×¨.",
                timer: { duration: 480, label: "×ª×¤×™×—×” ×§×¨×” (××™× ×™××•× 8 ×©×¢×•×ª)" },
                tips: "××¨×•×š ×™×•×ª×¨ = ×˜×¢× ×—××•×¥ ×™×•×ª×¨! ××¤×©×¨ ×œ×”×’×™×¢ ×¢×“ 36 ×©×¢×•×ª ×‘××™×“×ª ×”×¦×•×¨×š. ğŸ’¡ ×ª×–×›×•×¨×ª: ×œ×¤× ×™ ×©×ª×•×¦×™××• ××ª ×”×‘×¦×§ ××”××§×¨×¨, ×ª×¦×˜×¨×›×• ×œ×—×× ××ª ×”×ª× ×•×¨ ×œ××©×š 45-60 ×“×§×•×ª ×¢× ×¡×™×¨ ×”×•×œ× ×“×™ ×‘×¤× ×™×."
            },
            {
                title: "×—×™××•× ×ª× ×•×¨ ×•××¤×™×™×”",
                content: "**×—×œ×§ 1 - ×—×™××•× (50 ×“×§'):** ×—×××• ××ª ×”×ª× ×•×¨ ×œ-260Â°C ×¢× ×¡×™×¨ ×”×•×œ× ×“×™ ×‘×¤× ×™×. ×ª×•×š ×›×“×™, ×”×•×¦×™××• ××ª ×”×‘×¦×§ ××”××§×¨×¨ ×•×”× ×™×—×• ×¢×œ × ×™×™×¨ ××¤×™×™×”. ×—×¨×¦×• ×‘×–×”×™×¨×•×ª ×¢× ×œ×”×‘ ×—×“.\n\n**×—×œ×§ 2 - ××¤×™×™×” (48 ×“×§'):** ×”× ×™×—×• ××ª ×”×‘×¦×§ ×‘×¡×™×¨ ×”×—×, ×¡×’×¨×• ××›×¡×”. ××¤×• 20 ×“×§' ×‘-260Â°C, ××– ×”×¡×™×¨×• ××›×¡×”, ×”×•×¨×™×“×• ×œ-230Â°C, ×•×”××©×™×›×• 28 ×“×§'.",
                timer: { duration: 50, label: "â° ×—×™××•× ×”×ª× ×•×¨ - ×”×ª×—×™×œ×• ×›××Ÿ!" },
                temperature: "×ª× ×•×¨: 260Â°C â†’ 230Â°C",
                tips: "×”×©×ª××©×• ×‘×˜×™×™××¨ ×”×–×” ×œ×—×™××•× ×”×ª× ×•×¨. ×›×©×”×•× ××¦×œ×¦×œ, ×”×›× ×™×¡×• ××ª ×”×œ×—×! ××—×¨ ×›×š ×”×©×ª××©×• ×‘×˜×™×™××¨ ×©×œ ×”×˜×œ×¤×•×Ÿ ×©×œ×›× ×œ-20 ×“×§' ×¢× ××›×¡×” + 28 ×“×§' ×‘×œ×™ ××›×¡×”."
            },
            {
                title: "×§×™×¨×•×¨ ××œ×",
                content: "×”×•×¦×™××• ××ª ×”×œ×—× ×•×”× ×™×—×• ××•×ª×• ×¢×œ ×¨×©×ª ×§×™×¨×•×¨. ×–×” ×”×—×œ×§ ×”×§×©×” ×‘×™×•×ª×¨ - ××ª× ×—×™×™×‘×™× ×œ×—×›×•×ª ×œ×¤×—×•×ª 1-2 ×©×¢×•×ª ×œ×¤× ×™ ×”×—×™×ª×•×š! ×”×œ×—× ×¢×“×™×™×Ÿ ××ª×‘×©×œ ×‘×¤× ×™× ×•×”×¤×™×¨×•×¨×™×ª ××ª×§×‘×¢×ª.",
                timer: { duration: 90, label: "×–××Ÿ ×§×™×¨×•×¨" },
                tips: "×”×§×©×™×‘×• ×œ×•! ×œ×—× ×˜×¨×™ ××•×¦×™× ×¦×œ×™×œ×™ ×¤×¦×¤×•×¥ ×›×©×”×•× ××ª×§×¨×¨. ×× ×ª×—×ª×›×• ××•×§×“× ××“×™, ×”×¤× ×™× ×™×”×™×” ×“×‘×™×§."
            }
        ];

        let currentStep = 0;
        let timers = {};
        let timerIntervals = {};

        function updateActiveTimersIndicator() {
            const indicator = document.getElementById('activeTimersIndicator');
            if (!indicator) return;
            
            const activeCount = Object.values(timers).filter(t => t.running).length;
            
            if (activeCount > 0) {
                indicator.innerHTML = `<span class="timer-pulse"></span> ${activeCount} ×˜×™×™××¨${activeCount > 1 ? '×™×' : ''} ×¤×¢×™×œ${activeCount > 1 ? '×™×' : ''}`;
                indicator.style.display = 'flex';
            } else {
                indicator.style.display = 'none';
            }
        }

        function renderStep() {
            const step = recipeSteps[currentStep];
            const container = document.getElementById('stepContainer');
            const progressBar = document.getElementById('progressBar');
            
            progressBar.style.width = ((currentStep + 1) / recipeSteps.length * 100) + '%';
            
            updateActiveTimersIndicator();
            
            if (currentStep >= recipeSteps.length) {
                container.innerHTML = `
                    <div class="step-card completion">
                        <div class="completion-icon">ğŸ‰</div>
                        <h2>×›×œ ×”×›×‘×•×“!</h2>
                        <p style="font-size: 1.2em; color: #555; margin: 20px 0;">××¤×™×ª× ×›×™×›×¨ ×œ×—× ××—××¦×ª ××“×”×™××”!</p>
                        <p style="color: #777;">×ª×”× ×• ××”×œ×—× ×”×‘×™×ª×™ ×©×œ×›×. ×›×›×œ ×©×ª×ª×¨×’×œ×• ×™×•×ª×¨, ×›×š ×–×” ×™×”×™×” ×˜×•×‘ ×™×•×ª×¨!</p>
                        <button class="btn btn-success" onclick="resetApp()" style="margin-top: 30px;">
                            ğŸ”„ ×”×ª×—×œ ×›×™×›×¨ ×—×“×©×”
                        </button>
                    </div>
                `;
                return;
            }
            
            let html = `
                <div class="step-card">
                    <div class="step-header">
                        <div class="step-number">${currentStep + 1}</div>
                        <div class="step-title">${step.title}</div>
                    </div>
                    
                    <div class="step-content">
                        ${step.content}
                    </div>
            `;
            
            if (step.ingredients) {
                html += `
                    <div class="ingredients">
                        <h4>ğŸ“ ××¦×¨×›×™×:</h4>
                        ${step.ingredients.map(ing => `<div class="ingredient-item">â€¢ ${ing}</div>`).join('')}
                    </div>
                `;
            }
            
            if (step.temperature) {
                html += `<div class="temperature">ğŸŒ¡ï¸ ${step.temperature}</div>`;
            }
            
            if (step.tips) {
                html += `
                    <div class="tips">
                        <strong>ğŸ’¡ Tip:</strong> ${step.tips}
                    </div>
                `;
            }
            
            if (step.timer) {
                const timerId = `timer-${currentStep}`;
                const timerState = timers[timerId] || { remaining: step.timer.duration * 60, running: false };
                
                html += `
                    <div class="timer-section">
                        <div class="timer-label">${step.timer.label}</div>
                        <div class="timer-display" id="${timerId}-display">
                            ${formatTime(timerState.remaining)}
                        </div>
                        <div class="timer-buttons">
                            <button class="btn btn-primary" onclick="toggleTimer('${timerId}', ${step.timer.duration * 60})">
                                <span id="${timerId}-btn-text">${timerState.running ? 'â¸ï¸ ×”×©×”×”' : 'â–¶ï¸ ×”×ª×—×œ'}</span>
                            </button>
                            <button class="btn btn-primary" onclick="resetTimer('${timerId}', ${step.timer.duration * 60})">
                                ğŸ”„ ××¤×¡
                            </button>
                        </div>
                    </div>
                `;
            }
            
            html += `
                    <div class="navigation">
                        ${currentStep > 0 ? '<button class="btn btn-back" onclick="previousStep()">â†’ ×”×§×•×“×</button>' : ''}
                        <button class="btn btn-next" onclick="nextStep()">
                            ${currentStep < recipeSteps.length - 1 ? '×”×‘× â†' : '×¡×™×•×! ğŸ‰'}
                        </button>
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
            
            // Restore running timers
            Object.keys(timers).forEach(timerId => {
                if (timers[timerId].running) {
                    startTimerInterval(timerId);
                }
            });
        }

        function formatTime(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            
            if (hours > 0) {
                return `${hours}:${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
            }
            return `${minutes}:${String(secs).padStart(2, '0')}`;
        }

        function toggleTimer(timerId, initialDuration) {
            if (!timers[timerId]) {
                timers[timerId] = { remaining: initialDuration, running: false, startTime: null };
            }
            
            const timer = timers[timerId];
            timer.running = !timer.running;
            
            if (timer.running) {
                timer.startTime = Date.now();
            } else {
                timer.startTime = null;
            }
            
            const btnText = document.getElementById(`${timerId}-btn-text`);
            if (timer.running) {
                btnText.textContent = 'â¸ï¸ ×”×©×”×”';
                startTimerInterval(timerId);
            } else {
                btnText.textContent = 'â–¶ï¸ ×”×ª×—×œ';
                stopTimerInterval(timerId);
            }
            
            updateActiveTimersIndicator();
            saveProgress();
        }

        function startTimerInterval(timerId) {
            if (timerIntervals[timerId]) {
                clearInterval(timerIntervals[timerId]);
            }
            
            timerIntervals[timerId] = setInterval(() => {
                const timer = timers[timerId];
                if (timer.remaining > 0) {
                    timer.remaining--;
                    const display = document.getElementById(`${timerId}-display`);
                    if (display) {
                        display.textContent = formatTime(timer.remaining);
                    }
                    saveProgress();
                } else {
                    stopTimerInterval(timerId);
                    timer.running = false;
                    timer.startTime = null;
                    playNotification();
                    showNotification('â° ×”×˜×™×™××¨ ×”×¡×ª×™×™×!');
                    const btnText = document.getElementById(`${timerId}-btn-text`);
                    if (btnText) {
                        btnText.textContent = 'â–¶ï¸ ×”×ª×—×œ';
                    }
                    updateActiveTimersIndicator();
                    saveProgress();
                }
            }, 1000);
        }

        function stopTimerInterval(timerId) {
            if (timerIntervals[timerId]) {
                clearInterval(timerIntervals[timerId]);
                delete timerIntervals[timerId];
            }
        }

        function resetTimer(timerId, initialDuration) {
            stopTimerInterval(timerId);
            timers[timerId] = { remaining: initialDuration, running: false, startTime: null };
            const display = document.getElementById(`${timerId}-display`);
            if (display) {
                display.textContent = formatTime(initialDuration);
            }
            const btnText = document.getElementById(`${timerId}-btn-text`);
            if (btnText) {
                btnText.textContent = 'â–¶ï¸ ×”×ª×—×œ';
            }
            saveProgress();
        }

        function playNotification() {
            // Create multiple beep sounds for better attention
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            
            // Beep 3 times
            for (let i = 0; i < 3; i++) {
                setTimeout(() => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 800;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                }, i * 400);
            }
        }

        function showNotification(message) {
            // Try browser notification first
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('×œ×—× ××—××¦×ª', {
                    body: message,
                    icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="80" font-size="80">ğŸ</text></svg>',
                    tag: 'sourdough-timer',
                    requireInteraction: true
                });
            } else {
                // Fallback to alert
                alert(message);
            }
        }

        function nextStep() {
            currentStep++;
            saveProgress();
            window.scrollTo(0, 0);
            renderStep();
        }

        function previousStep() {
            if (currentStep > 0) {
                currentStep--;
                saveProgress();
                window.scrollTo(0, 0);
                renderStep();
            }
        }

        function resetApp() {
            currentStep = 0;
            timers = {};
            Object.keys(timerIntervals).forEach(stopTimerInterval);
            saveProgress();
            renderStep();
        }

        function saveProgress() {
            const timerData = {};
            Object.keys(timers).forEach(timerId => {
                const timer = timers[timerId];
                timerData[timerId] = {
                    remaining: timer.remaining,
                    running: timer.running,
                    startTime: timer.startTime || null
                };
            });
            
            localStorage.setItem('sourdoughProgress', JSON.stringify({
                currentStep,
                timers: timerData
            }));
        }

        function loadProgress() {
            const saved = localStorage.getItem('sourdoughProgress');
            if (saved) {
                const data = JSON.parse(saved);
                currentStep = data.currentStep || 0;
                
                // Restore timers and calculate elapsed time for running timers
                if (data.timers) {
                    const now = Date.now();
                    Object.keys(data.timers).forEach(timerId => {
                        const savedTimer = data.timers[timerId];
                        if (savedTimer.running && savedTimer.startTime) {
                            // Calculate how much time has passed
                            const elapsed = Math.floor((now - savedTimer.startTime) / 1000);
                            const remaining = Math.max(0, savedTimer.remaining - elapsed);
                            timers[timerId] = {
                                remaining: remaining,
                                running: remaining > 0,
                                startTime: now
                            };
                        } else {
                            timers[timerId] = {
                                remaining: savedTimer.remaining,
                                running: false,
                                startTime: null
                            };
                        }
                    });
                }
            }
        }

        // Request notification permission
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission();
        }

        // Initialize app
        loadProgress();
        renderStep();
    </script>
</body>
</html>